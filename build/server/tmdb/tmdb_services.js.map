{"version":3,"sources":["../../source/server/tmdb/tmdb_services.ts"],"names":[],"mappings":";AAAA,gCAAgC,mBAAmB,CAAC,CAAA;AAEpD,4BAA4B,uBAAuB,CAAC,CAAA;AACpD,IAAY,OAAO,WAAM,SAAS,CAAC,CAAA;AACnC,IAAY,EAAE,WAAM,SAAS,CAAC,CAAA;AAE9B;IAKI;QACI,IAAI,CAAC,eAAe,GAAG,IAAI,iCAAe,CAAC;QAC3C,IAAI,CAAC,cAAc,EAAE,CAAC;IAC1B,CAAC;IACO,sCAAc,GAAtB;QAAA,iBAgBC;QAfG,IAAI,OAAO,GAAG,IAAI,CAAC,eAAe,CAAC,UAAU,EAAE,CAAC;QAChD,EAAE,CAAA,CAAC,OAAO,CAAC,OAAO,CAAC,CAAA,CAAC;YAChB,OAAO,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;YACtB,IAAI,CAAC,sBAAsB,GAAG,IAAI,CAAC;YACnC,IAAI,CAAC,QAAQ,GAAG,OAAO,CAAC,IAAI,CAAC;QACjC,CAAC;QAAA,IAAI,CAAA,CAAC;YACF,OAAO,CAAC,OAAO,CAAC,SAAS,CACrB,UAAA,CAAC;gBACG,KAAI,CAAC,QAAQ,GAAG,CAAC,CAAC;gBAClB,KAAI,CAAC,sBAAsB,GAAG,IAAI,CAAC;gBACnC,OAAO,CAAC,GAAG,CAAC,mBAAmB,CAAC,CAAC;gBACjC,OAAO,CAAC,OAAO,CAAC,WAAW,EAAE,CAAC;YAClC,CAAC,CACJ,CAAC;QACN,CAAC;IACL,CAAC;IACD,UAAU;IACH,qCAAa,GAApB,UAAqB,KAAc;QAC/B,IAAI,OAAO,GAAG,IAAI,EAAE,CAAC,OAAO,EAAE,CAAC;QAC/B,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,YAAY,CACrC,wCAAwC,EACpC,EAAI,KAAK,EAAa,KAAK;YACvB,QAAQ,EAAU,OAAO;YACzB,OAAO,EAAW,yBAAW,CAAC,GAAG,EAAE,CAC1C,EAAE,UAAC,KAAK,EAAE,QAAQ,EAAE,IAAI;YACrB,EAAE,CAAA,CAAC,KAAK,CAAC,CAAA,CAAC;gBACN,MAAM,IAAI,KAAK,CAAC,KAAK,CAAC,CAAC;YAC3B,CAAC;YACD,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACnB,OAAO,CAAC,QAAQ,EAAE,CAAC;YACnB,OAAO,CAAC,WAAW,EAAE,CAAC;QAC1B,CAAC,CAAC,CAAC;QACP,MAAM,CAAC,OAAO,CAAC;IACnB,CAAC;IACM,yCAAiB,GAAxB,UAAyB,EAAW;QAChC,IAAI,OAAO,GAAG,IAAI,EAAE,CAAC,OAAO,EAAE,CAAC;QAC/B,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,YAAY,CACrC,kCAAkC,GAAC,EAAE,EACjC,EAAI,QAAQ,EAAU,OAAO;YACzB,OAAO,EAAW,yBAAW,CAAC,GAAG,EAAE,CAC1C,EAAE,UAAC,KAAK,EAAE,QAAQ,EAAE,IAAI;YACrB,EAAE,CAAA,CAAC,KAAK,CAAC,CAAA,CAAC;gBACN,MAAM,IAAI,KAAK,CAAC,KAAK,CAAC,CAAC;YAC3B,CAAC;YACD,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACnB,OAAO,CAAC,QAAQ,EAAE,CAAC;YACnB,OAAO,CAAC,WAAW,EAAE,CAAC;QAC1B,CAAC,CAAC,CAAC;QACP,MAAM,CAAC,OAAO,CAAC;IACnB,CAAC;IACM,uCAAe,GAAtB,UAAuB,EAAW,EAAE,aAAqB;QACrD,IAAI,OAAO,GAAG,IAAI,EAAE,CAAC,OAAO,EAAE,CAAC;QAC/B,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,YAAY,CACrC,kCAAkC,GAAC,EAAE,GAAC,UAAU,GAAC,aAAa,EAC1D,EAAI,QAAQ,EAAU,OAAO;YACzB,OAAO,EAAW,yBAAW,CAAC,GAAG,EAAE,CAC1C,EAAE,UAAC,KAAK,EAAE,QAAQ,EAAE,IAAI;YACrB,EAAE,CAAA,CAAC,KAAK,CAAC,CAAA,CAAC;gBACN,MAAM,IAAI,KAAK,CAAC,KAAK,CAAC,CAAC;YAC3B,CAAC;YACD,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACnB,OAAO,CAAC,QAAQ,EAAE,CAAC;YACnB,OAAO,CAAC,WAAW,EAAE,CAAC;QAC1B,CAAC,CAAC,CAAC;QACP,MAAM,CAAC,OAAO,CAAC;IACnB,CAAC;IACL,oBAAC;AAAD,CA5EA,AA4EC,IAAA;AA5EY,qBAAa,gBA4EzB,CAAA","file":"tmdb_services.js","sourcesContent":["import { tmdb_connection } from './tmdb_connection';\r\nimport { tmdb_session } from './tmdn_session';\r\nimport { config_tmdb } from '../config/config_tmdb';\r\nimport * as request from 'request';\r\nimport * as Rx from \"rxjs/Rx\";\r\n\r\nexport class tmdb_services {\r\n    connection_established: boolean;\r\n    private tmdb_connection : tmdb_connection;\r\n    private _session        : tmdb_session;\r\n\r\n    constructor(){\r\n        this.tmdb_connection = new tmdb_connection;\r\n        this.getSessionData();\r\n    }\r\n    private getSessionData(){\r\n        var session = this.tmdb_connection.getSession();\r\n        if(session.success){\r\n            console.log('done !');\r\n            this.connection_established = true;\r\n            this._session = session.data;\r\n        }else{\r\n            session.subject.subscribe(\r\n                x => {\r\n                    this._session = x;\r\n                    this.connection_established = true;\r\n                    console.log('connection done !');\r\n                    session.subject.unsubscribe();\r\n                }\r\n            );\r\n        }\r\n    }\r\n    //api tmdb\r\n    public getTVShowData(title : string) {\r\n        var subject = new Rx.Subject();\r\n        request(this.tmdb_connection.Create_query(\r\n            'https://api.themoviedb.org/3/search/tv',\r\n                {   query           : title,\r\n                    language        : 'en-US',\r\n                    api_key         : config_tmdb.key },\r\n            ), (error, response, body)=> {\r\n                if(error){ \r\n                    throw new Error(error);\r\n                }\r\n                subject.next(body);\r\n                subject.complete();\r\n                subject.unsubscribe();\r\n            });\r\n        return subject;\r\n    }\r\n    public getTVShowFullData(id : number){\r\n        var subject = new Rx.Subject();\r\n        request(this.tmdb_connection.Create_query(\r\n            'https://api.themoviedb.org/3/tv/'+id,\r\n                {   language        : 'en-US',\r\n                    api_key         : config_tmdb.key },\r\n            ), (error, response, body)=> {\r\n                if(error){ \r\n                    throw new Error(error);\r\n                }\r\n                subject.next(body);\r\n                subject.complete();\r\n                subject.unsubscribe();\r\n            });\r\n        return subject;\r\n    }\r\n    public getSeasonDetail(id : number, season_number: number){\r\n        var subject = new Rx.Subject();\r\n        request(this.tmdb_connection.Create_query(\r\n            'https://api.themoviedb.org/3/tv/'+id+'/season/'+season_number,\r\n                {   language        : 'en-US',\r\n                    api_key         : config_tmdb.key },\r\n            ), (error, response, body)=> {\r\n                if(error){ \r\n                    throw new Error(error);\r\n                }\r\n                subject.next(body);\r\n                subject.complete();\r\n                subject.unsubscribe();\r\n            });\r\n        return subject;\r\n    }\r\n}\r\n"]}