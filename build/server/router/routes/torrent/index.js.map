{"version":3,"sources":["../../source/server/router/routes/torrent/index.ts"],"names":[],"mappings":"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","file":"index.js","sourcesContent":["import * as express         from \"express\";\r\nimport * as _               from 'lodash';\r\nimport * as request         from 'request';\r\nimport * as cheerio         from 'cheerio';\r\nimport * as Rx              from 'rxjs/Rx';\r\n\r\nexport class torrent_routes {\r\n    private _app            : express.Express;\r\n\r\n    constructor(app){\r\n        this._app           = app;\r\n        this.setRoutes();\r\n    }\r\n    public setRoutes(){\r\n        this.get_torrents();\r\n    }\r\n    private get_torrents(){\r\n        this._app.get('/get_torrents/:TVShow_name/:season/:episode',(req, res)=>{\r\n            if(!req.body){\r\n                return res.sendStatus(400);\r\n            }else{\r\n                var google = require('google');\r\n                google.resultPerPage=10;\r\n                let _self = this;\r\n                let _res = res;\r\n                var query = '';\r\n                if(req.params.season<=9 && req.params.episode<=9){\r\n                    query = req.params.TVShow_name+' S0'+req.params.season+' E0'+req.params.episode+' site:extratorrent.cc';\r\n                }else if(req.params.season<=9 && req.params.episode>9){\r\n                    query = req.params.TVShow_name+' S0'+req.params.season+' E'+req.params.episode+' site:extratorrent.cc';\r\n                }\r\n                else if(req.params.season>9 && req.params.episode<=9){\r\n                    query = req.params.TVShow_name+' S'+req.params.season+' E0'+req.params.episode+' site:extratorrent.cc';\r\n                }\r\n                else if(req.params.season>9 && req.params.episode>9){\r\n                    query = req.params.TVShow_name+' S'+req.params.season+' E'+req.params.episode+' site:extratorrent.cc';\r\n                }\r\n                google(query, function(err, res){\r\n                    if(err){\r\n                        console.log(err);\r\n                    }else{\r\n                        let result = _self.select_links(res.links,req.params.TVShow_name,req.params.season,req.params.episode);\r\n                        result = _self.groups_release(result);\r\n                        result = _self.delete_duplicate(result);\r\n                        result = _self.torrent_link(result);\r\n                        if(result.length===0){\r\n                            return _res.json({success:false, result:'no data'});\r\n                        }else{\r\n                            var sub = _self.get_info_torrents(result)\r\n                            sub.subscribe(\r\n                                data => {\r\n                                        return _res.json({success:true, result:data});\r\n                                }\r\n                            );\r\n                        }\r\n                    }\r\n                });\r\n                \r\n            }\r\n        });\r\n    }\r\n    // [*] primero: se asegura que los links correspondan exclusivamente al capítulo\r\n    protected select_links(links:any, TVShow_name: string, season:number, episode:number){\r\n        let _links = [];\r\n        _.forEach(links, (element)=>{\r\n            let title=_.replace(element.title,'.',' ');\r\n            if(title.indexOf(TVShow_name) !== -1){\r\n                var query = '';\r\n                if(season<=9 && episode<=9){\r\n                    query = 'S0'+season+'E0'+episode;\r\n                }else if(season<=9 && episode>9){\r\n                    query = 'S0'+season+'E'+episode;\r\n                }else if(season>9 && episode<=9){\r\n                    query = 'S'+season+'E0'+episode;\r\n                }else if(season>9 && episode>9){\r\n                    query = 'S'+season+'E'+episode;\r\n                }\r\n                if(element.title.indexOf(query) !== -1){\r\n                    if(element.href.indexOf('search') === -1){\r\n                        _links.push(element);\r\n                    }\r\n                }\r\n            }\r\n        });\r\n        return _links;\r\n    }\r\n    // [*] segundo: obtener grupos de los links\r\n    protected groups_release(links){\r\n        let _links = links;\r\n        let _group_list = [\r\n            'dimension',\r\n            'avs',\r\n            'sva',\r\n            'hevc',\r\n            'batv',\r\n            'ctrlhd',\r\n            'd-zon3',\r\n            'ntb',\r\n            'don',\r\n            'form',\r\n            'xander',\r\n            'killers',\r\n            'lol',\r\n            'river',\r\n            'fum',\r\n            'fleet',\r\n            'shaanig',\r\n            'bajskorv'];\r\n        _.forEach(_links, (element, index)=>{\r\n            _.forEach(_group_list, (group)=>{\r\n                let title : string = _.lowerCase(element.title);\r\n                let grupo : string = group;\r\n                if(title.indexOf(grupo) !== -1){\r\n                    _links[index][\"group\"] = grupo;\r\n                }\r\n            });\r\n        });\r\n        return _links;\r\n    }\r\n    protected delete_duplicate(links){\r\n        let _links = links;\r\n        let _finale_links = [];\r\n        _.forEach(_links, (element, index)=>{\r\n            if(_finale_links.length===0){\r\n                _finale_links.push(element);\r\n            }else{\r\n                var link_splited = _.split(element.href, '/'); \r\n                var link_id = link_splited[4];\r\n                var counter = 0;\r\n                _.forEach(_finale_links, (e, i)=>{\r\n                    var finale_link = _.split(e.href, '/'); \r\n                    var finale_link_id = finale_link[4];\r\n                    if(finale_link_id === link_id){\r\n                        counter++;\r\n                    }\r\n                });\r\n                if(counter===0){\r\n                    _finale_links.push(element);\r\n                }\r\n            }\r\n        });\r\n        return _finale_links;\r\n    }\r\n    // [*] tercer: obtener links de los .torrent\r\n    protected torrent_link(links){\r\n        let _links = [];        \r\n        _.forEach(links, (element, index)=>{\r\n            let e = element;\r\n            var link_splited = _.split(element.href, '/'); \r\n            if(link_splited[3] === 'torrent_download' || link_splited[3] === 'torrent' || link_splited[3] === 'torrent_files' || link_splited[3] === 'torrent_trackers'){\r\n                e[\"torrent\"] = link_splited[0]+'//'+link_splited[2]+'/download/'+link_splited[4]+'/'+link_splited[5];\r\n            }\r\n            _links.push(e);\r\n        });\r\n        return _links;\r\n    } \r\n    //cuarto: obtener data en relación a seeders y leechers \r\n    protected get_info_torrents(links){\r\n        let _links = [];\r\n        let subject = new Rx.Subject();\r\n        var cont = 0;\r\n        var tam = links.length;\r\n \r\n        _.forEachRight(links, (element, index)=>{\r\n            let _link = _.replace(element.torrent, '/download/','/torrent/');\r\n            var e = element;\r\n            var options = {\r\n                url: _link,\r\n                method: 'GET'\r\n            };\r\n            request(options, (error, response, html)=>{\r\n                if(!error){\r\n                    var $ = cheerio.load(html);\r\n                    var err = $('h1.error').text();\r\n                    if(err.length===0){\r\n                        var info_torrent = {};\r\n                        $('td.tabledata0').filter(function(i){\r\n                            if(i===4){ //línea 4 de la página\r\n                                var data = $(this).text();\r\n                                data = _.lowerCase(data);\r\n                                data = _.replace(data, ' update', '');\r\n                                var info = _.split(data, ' ');\r\n                                info_torrent[\"seeds\"] = info[1];\r\n                                info_torrent[\"leechers\"] = info[3];\r\n                            }\r\n                            return true;\r\n                        });\r\n                        $('td.tabledata0').filter(function(i){\r\n                            if(i===5){ //línea 5 de la página\r\n                                if($(this).text().indexOf('MB') !== -1 || $(this).text().indexOf('GB') !== -1){\r\n                                    info_torrent[\"size\"] = $(this).text();\r\n                                }\r\n                            }\r\n                            if(i===6){\r\n                                if($(this).text().indexOf('MB') !== -1 || $(this).text().indexOf('GB') !== -1){\r\n                                    info_torrent[\"size\"] = $(this).text();\r\n                                }\r\n                            }\r\n                            return true;\r\n                        });\r\n                        e[\"info_torrent\"] = info_torrent;\r\n                        _links.push(e);\r\n                        if(cont === tam-1){\r\n                            subject.next(_links);\r\n                        }\r\n                        cont++;\r\n                    }else{\r\n                        if(cont === tam-1){\r\n                            subject.next(_links);\r\n                        }\r\n                        cont++;\r\n                    }\r\n                }else{\r\n                    console.log('error '+error);\r\n                }\r\n            });\r\n        });\r\n        return subject;\r\n    }\r\n}"]}